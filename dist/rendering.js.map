{"version":3,"sources":["../src/rendering.js"],"names":["link","scope","elem","attrs","ctrl","data","panel","find","events","on","render","console","log","renderHist","margin","top","right","bottom","left","width","height","x","d3","scaleTime","domain","Date","rangeRound","y","scaleLinear","range","histogram","value","d","date","thresholds","ticks","timeWeek","svg","select","append","attr","call","axisBottom","csv","type","error","bins","max","length","bar","selectAll","enter","x0","x1","text","formatCount","parseDate","$"],"mappings":"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","file":"rendering.js","sourcesContent":["import $ from 'jquery';\nimport * as d3 from \"d3\";\n\nexport default function link(scope, elem, attrs, ctrl) {\n    let data;\n    const panel = ctrl.panel;\n\n    elem = elem.find('.panel-content');\n\n    ctrl.events.on('render', function () {\n        render();\n    });\n\n    function render() {\n        console.log(elem);\n        console.log(panel);\n    }\n\n    function renderHist() {\n        var margin = {top: 10, right: 30, bottom: 30, left: 30},\n            width = 960 - margin.left - margin.right,\n            height = 500 - margin.top - margin.bottom;\n\n        var x = d3.scaleTime()\n            .domain([new Date(2015, 0, 1), new Date(2016, 0, 1)])\n            .rangeRound([0, width]);\n\n        var y = d3.scaleLinear()\n            .range([height, 0]);\n\n        var histogram = d3.histogram()\n            .value(function(d) { return d.date; })\n            .domain(x.domain())\n            .thresholds(x.ticks(d3.timeWeek));\n\n        var svg = d3.select(\"div.panel-content > .panel-height-helper\").append(\"svg\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n        svg.append(\"g\")\n            .attr(\"class\", \"axis axis--x\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(d3.axisBottom(x));\n\n        d3.csv(\"https://bl.ocks.org/mbostock/raw/b2fee5dae98555cf78c9e4c5074b87c3/homicides.csv\", type, function(error, data) {\n            if (error) throw error;\n\n            var bins = histogram(data);\n\n            y.domain([0, d3.max(bins, function(d) { return d.length; })]);\n\n            var bar = svg.selectAll(\".bar\")\n                .data(bins)\n                .enter().append(\"g\")\n                .attr(\"class\", \"bar\")\n                .attr(\"transform\", function(d) { return \"translate(\" + x(d.x0) + \",\" + y(d.length) + \")\"; });\n\n            bar.append(\"rect\")\n                .attr(\"x\", 1)\n                .attr(\"width\", function(d) { return x(d.x1) - x(d.x0) - 1; })\n                .attr(\"height\", function(d) { return height - y(d.length); });\n\n            bar.append(\"text\")\n                .attr(\"dy\", \".75em\")\n                .attr(\"y\", 6)\n                .attr(\"x\", function(d) { return (x(d.x1) - x(d.x0)) / 2; })\n                .attr(\"text-anchor\", \"middle\")\n                .text(function(d) { return formatCount(d.length); });\n        });\n\n        function type(d) {\n            d.date = parseDate(d.date);\n            return d;\n        }\n    }\n\n}\n"]}