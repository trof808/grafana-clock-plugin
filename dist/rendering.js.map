{"version":3,"sources":["../src/rendering.js"],"names":["link","scope","elem","attrs","ctrl","panel","events","on","render","console","log","histData","length","items","renderHist","values","map","d","y","formatCount","d3","format","margin","top","right","bottom","left","width","height","svg","document","querySelectorAll","select","append","attr","max","min","x","scaleLinear","domain","range","call","axisBottom","data","histogram","thresholds","ticks","axisLeft","yMax","yMin","selectAll","enter","x0","x1","style","$"],"mappings":"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","file":"rendering.js","sourcesContent":["import $ from 'jquery';\nimport * as d3 from \"d3\";\n\nexport default function link(scope, elem, attrs, ctrl) {\n    const panel = ctrl.panel;\n    ctrl.events.on('render', function () {\n        render();\n    });\n\n    function render() {\n        console.log(panel);\n        if (panel.histData.length > 0 && panel.histData[0].items.length > 0) {\n            renderHist();\n        }\n    }\n\n    function renderHist() {\n        // const xData = data.items.map(d => d.x);\n        const values = panel.histData[0].items.map(d => d.y);\n        var formatCount = d3.format(\",.0f\");\n\n        var margin = {top: 10, right: 30, bottom: 30, left: 40},\n            width = 460 - margin.left - margin.right,\n            height = 400 - margin.top - margin.bottom;\n\n        var svg;\n\n        if (document.querySelectorAll(\"panel-plugin-test-clock-plugin.panel-height-helper ng-transclude.panel-height-helper svg\").length === 0) {\n            svg = d3.select(\"panel-plugin-test-clock-plugin.panel-height-helper ng-transclude.panel-height-helper\").append(\"svg\");\n        } else {\n            svg = d3.select(\"panel-plugin-test-clock-plugin.panel-height-helper ng-transclude.panel-height-helper svg\");\n        }\n\n        svg\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n        var max = d3.max(values);\n        var min = d3.min(values);\n\n        var x = d3.scaleLinear()\n            .domain([min, max])\n            .range([margin.left, width - margin.right]);\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(d3.axisBottom(x));\n\n        var y = d3.scaleLinear()\n            .range([height, 0]);\n\n        var data = d3.histogram()\n            .domain(x.domain())\n            .thresholds(x.ticks(values.length))\n            (values);\n\n        y.domain([0, d3.max(data, function(d) { return d.length; })]);\n        svg.append(\"g\")\n            .call(d3.axisLeft(y));\n\n        console.log(data);\n\n        var yMax = d3.max(data, function(d){return d[0]});\n        var yMin = d3.min(data, function(d){return d[0]});\n\n        console.log(yMax);\n        console.log(yMin);\n\n        svg.selectAll(\"rect\")\n            .data(data)\n            .enter()\n            .append(\"rect\")\n            .attr(\"x\", 1)\n            .attr(\"transform\", function(d) { return \"translate(\" + x(d.x0) + \",\" + y(d[0] || 0) / 2 + \")\"; })\n            .attr(\"width\", function(d) { return x(d.x1) - x(d.x0) -1 ; })\n            .attr(\"height\", function(d) { return (height - y(d[0] || 0)) / 2; })\n            .style(\"fill\", \"#69b3a2\")\n    }\n\n}\n"]}